---
import ContactButton from './ContactButton.astro';
import { marked } from 'marked';

interface FaqItem {
  question: string;
  answer: string;
}

interface Props {
  title?: string;
  faqs: FaqItem[];
}

const { title = "Preguntas Frecuentes", faqs } = Astro.props;
---

<section class="container mx-auto px-6 py-16">
  <h2 class="text-3xl font-bold text-center mb-10">{title}</h2>

  <div class="space-y-4 max-w-3xl mx-auto">
    {faqs.map(({ question, answer }) => (
      <details class="collapse border border-base-300 bg-base-100 rounded-box">
        <summary class="collapse-title text-lg font-semibold">
          {question}
        </summary>
        <div class="collapse-content text-base leading-relaxed">
          <div class="markdown-content" set:html={marked.parse(answer)}/>
        </div>
      </details>
    ))}
  </div>
  <div class="flex justify-center mt-8">
    <ContactButton link="/contacto" text="PregÃºntanos" />
  </div>
  <script 
    type="application/ld+json"
    set:html={ JSON.stringify({
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": faqs.map(faq => ({
          "@type": "Question",
          "name": faq.question,
          "acceptedAnswer": {
            "@type": "Answer",
            "text": faq.answer.replace(/<\/?[^>]+>/g, "")
          }
        }))
    })}
  />
</section>

<style is:global>
  .markdown-content ul {
    list-style-type: disc;
    padding-left: 1.5rem;
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
  }
  
  .markdown-content ol {
    list-style-type: decimal;
    padding-left: 1.5rem;
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
  }

  .markdown-content strong {
    font-weight: 700;
  }

  .markdown-content p {
    margin-bottom: 0.75rem;
  }
  
  .markdown-content p:last-child {
    margin-bottom: 0;
  }
</style> 

